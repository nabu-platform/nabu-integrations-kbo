<sequence id="7f1abdd3da524ee1b14f704914574dfb">
	<map id="0907090351fd49bb83363928a2f61053"
		comment="We assume you want the data for the previous day"
		label="input/year == null &amp;&amp; input/month == null &amp;&amp; input/day == null">
		<invoke id="9c33891c711c4e7ebb52d9c0e4a6b2de"
			resultName="resultc44819f78dd24445a75616c20f1b42e2"
			serviceId="nabu.utils.Date.incrementDuration"
			x="30"
			y="26">
			<link id="7c5fcd1989a44e90a491338ff14fbd8a"
				fixedValue="true">
				<from>-1</from>
				<to>times</to>
			</link>
			<link id="4afe4d7b8512480b8feaf25cdb2484ea"
				fixedValue="true">
				<from>P1D</from>
				<to>duration</to>
			</link>
		</invoke>
		<invoke id="2c34d372f4814396bfb5f1f342c40829"
			invocationOrder="1"
			resultName="result716080d8a8914c64b0fd1ec4d212e4f4"
			serviceId="nabu.utils.Date.toValues"
			x="311"
			y="146">
			<link id="1ef9c4caf364479ebe62f4d8dfadc5f8">
				<from>resultc44819f78dd24445a75616c20f1b42e2/date</from>
				<to>date</to>
			</link>
			<link id="e162311e77b64e18a288bfceaa416b55"
				fixedValue="true">
				<from>CET</from>
				<to>timezone</to>
			</link>
		</invoke>
		<link id="dac4bcdeba1b4e0c82028ce08864d733">
			<from>result716080d8a8914c64b0fd1ec4d212e4f4/values/year</from>
			<to>input/year</to>
		</link>
		<invoke id="75f75c0629e2462ebb93516c684d774d"
			invocationOrder="2"
			resultName="result4ed668f2fb424b0eabde7e49448c72f1"
			serviceId="nabu.utils.String.pad"
			x="697"
			y="65">
			<link id="64efa926b98c4ef1b2366804b50ed399">
				<from>result716080d8a8914c64b0fd1ec4d212e4f4/values/month</from>
				<to>content</to>
			</link>
			<link id="874624fdd0f545f086f2bd4d490bc278"
				fixedValue="true">
				<from>0</from>
				<to>pad</to>
			</link>
			<link id="f915d772158643969d616eee91f2e6e3"
				fixedValue="true">
				<from>2</from>
				<to>length</to>
			</link>
		</invoke>
		<link id="1f5d86b2fcb449939a56e6d02605871e">
			<from>result4ed668f2fb424b0eabde7e49448c72f1/padded</from>
			<to>input/month</to>
		</link>
		<invoke id="71405fafcc2440379d9348f82f4e2448"
			invocationOrder="2"
			resultName="result71405fafcc2440379d9348f82f4e2448"
			serviceId="nabu.utils.String.pad"
			x="524"
			y="243">
			<link id="1cf80bed366f420387618f722aa816da">
				<from>result716080d8a8914c64b0fd1ec4d212e4f4/values/day</from>
				<to>content</to>
			</link>
			<link id="1973873633a24ff7b5c6bf639fdc8b9c"
				fixedValue="true">
				<from>0</from>
				<to>pad</to>
			</link>
			<link id="34997fbe668644faac79eb47d15865f1"
				fixedValue="true">
				<from>2</from>
				<to>length</to>
			</link>
		</invoke>
		<link id="0470d0db1c164c33b225017b2914e311">
			<from>result71405fafcc2440379d9348f82f4e2448/padded</from>
			<to>input/day</to>
		</link>
	</map>
	<map id="afeb583b4b88422ca469f2b620949c57"
		label="input/number == null">
		<invoke id="57c773b325154f6bbe6e7652d08398d9"
			resultName="result763658a5933a4e439b1625ec6580aad7"
			serviceId="nabu.integrations.kbo.csv.utils.calculateNumber"
			x="205"
			y="112">
			<link id="e43a36e6608e4229bd6942a7ed788e97">
				<from>input/year</from>
				<to>year</to>
			</link>
			<link id="5d515fe096d1405da037c5bcff1e4245">
				<from>input/month</from>
				<to>month</to>
			</link>
			<link id="b0d2d110f0dd41b7a52a978c82807466">
				<from>input/day</from>
				<to>day</to>
			</link>
		</invoke>
		<link id="df8c14822ada47a1bb930a23c92a503b">
			<from>result763658a5933a4e439b1625ec6580aad7/number</from>
			<to>input/number</to>
		</link>
	</map>
	<map id="c867f96742fa40f78e53542900064c2a"
		comment="Map login properties">
		<link id="c14bde6d3f9b45c590c935c4b7736ae9">
			<from>input/username</from>
			<to>username/value</to>
		</link>
		<link id="347af6cd5d6d43a998316f5f793a1568">
			<from>input/password</from>
			<to>password/value</to>
		</link>
		<link id="e5113a66ff9142fa858028e22ea50aac"
			fixedValue="true">
			<from>j_username</from>
			<to>username/key</to>
		</link>
		<link id="4bfec5919a85435aa24bdd66e6b2507a"
			fixedValue="true">
			<from>j_password</from>
			<to>password/key</to>
		</link>
	</map>
	<map id="684031b72df94d0cb9f6c41f63533cf9"
		comment="Log in (the http client will remember the cookies)">
		<invoke id="e77e19a0d1b34849b1ae5d469c82b7da"
			invocationOrder="1"
			resultName="result780e4e31ec7546ae958737e4c1afd225"
			serviceId="nabu.protocols.http.client.Services.execute"
			x="305"
			y="202">
			<link id="a7229c88174d40988c0036619ab9e8ee"
				fixedValue="true">
				<from>https://kbopub.economie.fgov.be/kbo-open-data/static/j_spring_security_check</from>
				<to>url</to>
			</link>
			<link id="3eed1b88bb8246bf8d07999df427d461"
				fixedValue="true">
				<from>POST</from>
				<to>method</to>
			</link>
			<link id="17d0731a9e1248d1a9bf1484580c5a14">
				<from>resultfe8cdcd6a0a7429ba1a6286de92c2ad2/part</from>
				<to>part</to>
			</link>
		</invoke>
		<invoke id="8a6f34573ff54e7d8de9f40ab07f6509"
			resultName="resultfe8cdcd6a0a7429ba1a6286de92c2ad2"
			serviceId="nabu.protocols.http.client.Services.newFormInput"
			x="23"
			y="80">
			<link id="3bd4aa1085544761becb7cc8359fae24">
				<from>username</from>
				<to>parameters[0]</to>
			</link>
			<link id="50b210077ba644239b8806fe73d189c3">
				<from>password</from>
				<to>parameters[1]</to>
			</link>
		</invoke>
	</map>
	<switch id="b27c80f02b144458a82b7bb7e42f954a"
		query="input/full">
		<map id="34fbdf124fb34230afcd3e4f73fca3f0"
			label="true">
			<link id="874271a596de49c8906baba4627261eb"
				fixedValue="true">
				<from>Full</from>
				<to>keyword</to>
			</link>
		</map>
		<map id="5336d787b09140209d98b25aad3df332">
			<link id="513196502659444796dbd67251a892ef"
				fixedValue="true">
				<from>Update</from>
				<to>keyword</to>
			</link>
		</map>
	</switch>
	<map id="e954f4a22b8c4065a7145e9adbc933c0">
		<invoke id="24d6556bdbe2418293372ec121d37ccc"
			resultName="resulta9aa4346b25648979c41f5f0dd421313"
			serviceId="nabu.protocols.http.client.Services.execute"
			x="90"
			y="85">
			<link id="2405bd035b814660ab3aaa77108a190f"
				fixedValue="true">
				<from>="https://kbopub.economie.fgov.be/kbo-open-data/affiliation/xml/files/KboOpenData_" + input/number + "_" + input/year + "_" + input/month + "_" + input/day + "_" + keyword + ".zip"</from>
				<to>url</to>
			</link>
			<link id="dced737f932b46d89569dac6081f582e"
				fixedValue="true">
				<from>GET</from>
				<to>method</to>
			</link>
		</invoke>
		<link id="3fb3abae794843bfad190d88e3d662ce">
			<from>resulta9aa4346b25648979c41f5f0dd421313/response</from>
			<to>response</to>
		</link>
	</map>
	<throw id="c054dff4a88549b39023d37ce035634b"
		description="=&quot;Download failed: &quot; + response/code"
		label="response/code != 200"
		message="Download failed"/>
	<map id="4ce646ea60214000bd85232307ea719d">
		<invoke id="34ec0e89a5bf41debfdd01b336c8340b"
			invocationOrder="1"
			resultName="resulta326e93d0c4a4ca498d558f31d591a39"
			serviceId="nabu.data.mime.Services.getContent"
			x="119"
			y="110">
			<link id="4ab64d2e7c754f10a19b7ba1cc06ece5">
				<from>response/content</from>
				<to>part</to>
			</link>
		</invoke>
		<invoke id="84c840b70e8f4fcfabec22ce5cb08c5c"
			invocationOrder="2"
			resultName="result87d5b64287a74893b8e168b4e8f14b03"
			serviceId="nabu.frameworks.datastore.Services.store"
			x="461"
			y="268">
			<link id="15cbd1b01b544aca85ebf241e353e100">
				<from>resulta326e93d0c4a4ca498d558f31d591a39/content</from>
				<to>stream</to>
			</link>
			<link id="f9baa9ea5cc4457d81bf254d49f46760"
				fixedValue="true">
				<from>="KboOpenData_" + input/number + "_" + input/year + "_" + input/month + "_" + keyword + ".zip"</from>
				<to>name</to>
			</link>
			<link id="cb81b06817cf43819bb193cfc46139b7"
				fixedValue="true">
				<from>application/zip</from>
				<to>contentType</to>
			</link>
		</invoke>
		<link id="591c8b9eaa8f46e6878e360d937af64a">
			<from>result87d5b64287a74893b8e168b4e8f14b03/uri</from>
			<to>output/uri</to>
		</link>
		<link id="a5cbc1e4ee274e719f38c997cf45492f">
			<from>input/year</from>
			<to>output/year</to>
		</link>
		<link id="9d2d3dcb5c1041b2bf7b7e8453685e90">
			<from>input/month</from>
			<to>output/month</to>
		</link>
		<link id="30f681f285684ae1b52245585fddd010">
			<from>input/number</from>
			<to>output/number</to>
		</link>
		<link id="54e815b9d500420aaa267343f14e5346">
			<from>input/day</from>
			<to>output/day</to>
		</link>
	</map>
</sequence>